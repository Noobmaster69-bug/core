"use strict";(self.webpackChunkms_ui=self.webpackChunkms_ui||[]).push([[2288,4717,8641,6992,6875,1633],{8641:function(e,n,t){t.r(n),t.d(n,{default:function(){return u}});var r=t(6960);function u(e){return e?function(n){r.Am[e](n,{position:"bottom-center",autoClose:2e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}:function(e){(0,r.Am)(e,{position:"bottom-center",autoClose:2e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}}},5139:function(e,n,t){t.r(n),t.d(n,{useProtcolConfig:function(){return f},useProvision:function(){return d},useServiceInfo:function(){return l},useTask:function(){return m}});var r=t(5861),u=t(7757),a=t.n(u),i=t(4569),s=t.n(i),o=t(1933),c=t(8641);function l(){return(0,o.useQuery)("service-info",(0,r.Z)(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s().get("/microservices").then((function(e){return e.data}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),{staleTime:6e4})}function d(e){var n=e.onSuccess,t=void 0===n?function(){}:n,r=(0,o.useQueryClient)(),u=(0,c.default)("error");return(0,o.useMutation)((function(e){return s().get("/devies/provision",{params:{id:e}})}),{onSuccess:function(){t(),r.invalidateQueries("devices-info")},onError:function(e,n,t){var r;u(null===(r=e.response)||void 0===r?void 0:r.data)}})}function f(e){return(0,o.useQuery)("protocol?".concat(e),(0,r.Z)(a().mark((function n(){var t;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s().get("/protocol",{params:{id:e}}).then((function(e){return e.data}));case 2:return t=n.sent,n.abrupt("return",t);case 4:case"end":return n.stop()}}),n)}))),{staleTime:6e4})}function m(){return(0,o.useQuery)("task",(0,r.Z)(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s().get("/tasks").then((function(e){return e.data}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),{staleTime:6e4})}},4717:function(e,n,t){t.r(n),t.d(n,{useDevicesInfo:function(){return f},useModelsInfo:function(){return m},useMutationModel:function(){return p},useProtcolConfig:function(){return l.useProtcolConfig},useProvision:function(){return l.useProvision},useServiceInfo:function(){return l.useServiceInfo},useSocket:function(){return d.useSocket},useTask:function(){return l.useTask},useToast:function(){return v}});var r=t(5861),u=t(7757),a=t.n(u),i=t(1933),s=t(4569),o=t.n(s),c=t(8641),l=t(5139),d=t(6875);function f(){return(0,i.useQuery)("devices-info",(0,r.Z)(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o().get("/devices/info").then((function(e){return e.data}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),{staleTime:6e4})}function m(){return(0,i.useQuery)("models-info",(0,r.Z)(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o().get("/models/info").then((function(e){return e.data}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),{staleTime:6e4})}function p(e){var n=e.onSuccess,t=(0,i.useQueryClient)(),r=(0,c.default)("error");return(0,i.useMutation)((function(e){return o().post("/models",e)}),{onSuccess:function(){n(),t.invalidateQueries("models-info")},onError:function(e,n,t){var u;r(null===(u=e.response)||void 0===u?void 0:u.data)}})}function v(e){return(0,c.default)(e)}},6875:function(e,n,t){t.r(n),t.d(n,{useSocket:function(){return i}});var r=t(885),u=t(2791),a=t(6932);function i(e){var n=(0,u.useRef)((0,a.ZP)()),t=(0,u.useState)([]),i=(0,r.Z)(t,2),s=i[0],o=i[1];return(0,u.useEffect)((function(){return console.log(""),n.current.on("connect",(function(){n.current.emit(e,!0),n.current.on(e,(function(e){o(e)}))})),function(){}}),[n,e]),s}},2288:function(e,n,t){t.r(n),t.d(n,{default:function(){return m}});var r=t(4942),u=t(1413),a=t(2982),i=t(885),s=t(1633),o=t(2791),c=t(4717),l=t(8182),d=t(6871),f=t(184);function m(){var e=(0,d.s0)(),n=(0,o.useState)("modbusChannels"),t=(0,i.Z)(n,2),m=t[0],h=t[1],x=(0,o.useState)([]),j=(0,i.Z)(x,2),b=j[0],y=j[1],g=(0,o.useState)(!1),_=(0,i.Z)(g,2),C=_[0],N=_[1],S=(0,c.useMutationModel)({onSuccess:function(){return e(-1)}}).mutate,E={modbusChannels:["channel_name","fc","addr","quantity","parse","scale","precision"]},k=(0,o.useRef)();function w(e){e.preventDefault(),y([].concat((0,a.Z)(b),[E[m].map((function(n,t){return"number"===e.target[n].dataset.type?parseFloat(e.target[n].value):e.target[n].value}))])),console.log("reset"),e.target.reset(),e.target.blur()}function I(e,n){e.preventDefault(),b[n]=E[m].map((function(n,t){return"number"===e.target[n].dataset.type?parseFloat(e.target[n].value):e.target[n].value})),y(b)}return(0,f.jsxs)("div",{className:s.default.container,children:[(0,f.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},ref:k,children:[(0,f.jsxs)("div",{className:s.default.inputFields,children:[(0,f.jsxs)("div",{className:s.default.inputField,children:[(0,f.jsx)("div",{children:"Name:"}),(0,f.jsx)("input",{name:"name",type:"text",id:"name"})]}),(0,f.jsxs)("div",{className:s.default.inputField,children:[(0,f.jsx)("div",{children:"Manufacture:"}),(0,f.jsx)("input",{name:"manufacture",type:"text",id:"manufacture"})]})]}),(0,f.jsx)("div",{className:s.default.inputFields,children:(0,f.jsxs)("div",{className:s.default.inputField,children:[(0,f.jsx)("div",{children:"Type: "}),(0,f.jsx)("select",{className:s.default.field,onChange:function(e){return h(e.target.value)},children:(0,f.jsx)("option",{value:"modbusChannels",children:"Modbus"})})]})}),(0,f.jsx)("input",{type:"submit",style:{display:"none"}})]}),(0,f.jsx)("div",{className:s.default.tableContainer,children:(0,f.jsxs)("div",{className:s.default.table,children:[(0,f.jsx)("div",{className:s.default.tr,children:{modbusChannels:["Channel Name","Function","Address","Quantity","Parse","Scale","Precision"]}[m].map((function(e,n){return(0,f.jsx)("div",{className:s.default.td,children:(0,f.jsx)("div",{children:e})},"tableHead"+n)}))}),b.map((function(e,n){return(0,f.jsxs)("form",{className:s.default.tr,onSubmit:function(e){I(e,n)},onBlur:function(e){I(e,n)},children:[(0,f.jsx)(v,{channel:e}),(0,f.jsx)("input",{type:"submit",hidden:!0})]},"channels"+n)})),(0,f.jsxs)("form",{className:(0,l.Z)([s.default.tr,s.default.addRow,C&&s.default.addRowactive]),onSubmit:w,onFocus:function(e){w(e),N(!0)},onBlur:function(e){w(e),N(!1)},children:[(0,f.jsx)(p,{}),(0,f.jsx)("input",{type:"submit",hidden:!0})]}),(0,f.jsx)("button",{className:s.default.next,onClick:function(){var e={name:k.current.name.value,manufacture:k.current.manufacture.value,type:m,channels:b.map((function(e){return e.reduce((function(e,n,t){return(0,u.Z)((0,u.Z)({},e),{},(0,r.Z)({},E[m][t],n))}),{})}))};S(e)},children:"Create"})]})})]})}function p(e){e.type;return(0,f.jsx)(v,{})}function v(e){var n=e.channel,t=void 0===n?["","03","","1","Int16BE",1,1]:n,r=(0,o.useState)("1"),u=(0,i.Z)(r,2),a=u[0],c=u[1];return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{className:s.default.td,children:(0,f.jsx)("input",{type:"text",name:"channel_name",defaultValue:t[0],required:!0})}),(0,f.jsx)("div",{className:s.default.td,children:(0,f.jsx)("select",{name:"fc",defaultValue:t[1],children:(0,f.jsx)("option",{value:"03",children:"03"})})}),(0,f.jsx)("div",{className:s.default.td,children:(0,f.jsx)("input",{type:"text",name:"addr",defaultValue:t[2],required:!0})}),(0,f.jsx)("div",{className:s.default.td,children:(0,f.jsxs)("select",{name:"quantity",onChange:function(e){return c(e.target.value)},"data-type":"number",defaultValue:t[3],children:[(0,f.jsx)("option",{value:"1",children:"1"}),(0,f.jsx)("option",{value:"2",children:"2"}),(0,f.jsx)("option",{value:"4",children:"4"})]})}),(0,f.jsx)("div",{className:s.default.td,children:(0,f.jsxs)("select",{name:"parse",defaultValue:t[4],children:["1"===a&&["Int16BE","Int16LE","UInt16BE","UInt16LE"].map((function(e){return(0,f.jsx)("option",{value:e,children:e},e)})),"2"===a&&["Int32BE","Int32LE","UInt32BE","UInt32LE","FloatBE","FloatLE"].map((function(e){return(0,f.jsx)("option",{value:e,children:e},e)})),"4"===a&&["BigInt64BE","BigInt64LE","BigUInt64BE","BigUInt64LE","DoubleBE","DoubleLE"].map((function(e){return(0,f.jsx)("option",{value:e,children:e},e)}))]})}),(0,f.jsx)("div",{className:s.default.td,children:(0,f.jsx)("input",{type:"number",name:"scale",step:"any",defaultValue:t[5]||1,"data-type":"number"})}),(0,f.jsx)("div",{className:s.default.td,children:(0,f.jsx)("input",{type:"number",name:"precision",defaultValue:t[6]||1,"data-type":"number"})})]})}},1633:function(e,n,t){t.r(n),n.default={container:"Create_container__slGu8",inputFields:"Create_inputFields__dXLeu",inputField:"Create_inputField__O0i+y",field:"Create_field__as6i3",tableContainer:"Create_tableContainer__ZuNta",table:"Create_table__a7c0y",tr:"Create_tr__Bunrt",td:"Create_td__AjYTY",addRow:"Create_addRow__Sgari",addRowactive:"Create_addRowactive__uLzEv",next:"Create_next__NzRsY"}},2982:function(e,n,t){t.d(n,{Z:function(){return a}});var r=t(907);var u=t(181);function a(e){return function(e){if(Array.isArray(e))return(0,r.Z)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,u.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}}]);
//# sourceMappingURL=2288.66e9834f.chunk.js.map